<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>大模型部署(一)——服务器环境安装 - 博客</title><meta name="description" content="本文介绍 在部署基于 NVIDIA GPU 的大语言模型服务器时，确保系统具备合适的驱动程序和软件环境至关重要。首先，安装 NVIDIA GPU 驱动程序以启用 GPU 加速功能；接着，安装 CUDA 工具包来提供必要的编程接口和支持库；最后，安装 cuDNN 以加速深度神经网络的训练过程。这些步骤共同构成了一个高效的深度学习开发环境，能够显著提升模型训练和推理的速度。 ⚠️注意：本文默认你会Linux操作基础，如果不会请先行学习Linux操作系统 ⚠️注意：本文默认你会Linux操作基础，如果不会请先行学习Linux操作系统 ⚠️注意：本文默认你会Linux操作基础，如果不会请先行学习Linux操作系统 本文章使用的软件版本将以本文编写时的最新版本作为演示（使用其他版本请注意安装方式），以下是所需的驱动软件的版本号。 1. 备份原文件 $ cd /etc/apt $ mv sources.list sources.list.bak 2. 创建新文件 $ touch sources.list 3. 在文件内写入下述源地址 # 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释 deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ mantic main restricted universe&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://jie2gg.github.io/ji-qun-bu-shu-da-mo-xingyi-fu-wu-qi-huan-jing-an-zhuang.html"><link rel="alternate" type="application/atom+xml" href="https://jie2gg.github.io/feed.xml"><link rel="alternate" type="application/json" href="https://jie2gg.github.io/feed.json"><link rel="stylesheet" href="https://jie2gg.github.io/assets/css/style.css?v=69aee13592669c1a8668a208ab37bc94"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://jie2gg.github.io/ji-qun-bu-shu-da-mo-xingyi-fu-wu-qi-huan-jing-an-zhuang.html"},"headline":"大模型部署(一)——服务器环境安装","datePublished":"2024-08-16T09:44","dateModified":"2024-08-16T11:34","description":"本文介绍 在部署基于 NVIDIA GPU 的大语言模型服务器时，确保系统具备合适的驱动程序和软件环境至关重要。首先，安装 NVIDIA GPU 驱动程序以启用 GPU 加速功能；接着，安装 CUDA 工具包来提供必要的编程接口和支持库；最后，安装 cuDNN 以加速深度神经网络的训练过程。这些步骤共同构成了一个高效的深度学习开发环境，能够显著提升模型训练和推理的速度。 ⚠️注意：本文默认你会Linux操作基础，如果不会请先行学习Linux操作系统 ⚠️注意：本文默认你会Linux操作基础，如果不会请先行学习Linux操作系统 ⚠️注意：本文默认你会Linux操作基础，如果不会请先行学习Linux操作系统 本文章使用的软件版本将以本文编写时的最新版本作为演示（使用其他版本请注意安装方式），以下是所需的驱动软件的版本号。 1. 备份原文件 $ cd /etc/apt $ mv sources.list sources.list.bak 2. 创建新文件 $ touch sources.list 3. 在文件内写入下述源地址 # 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释 deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ mantic main restricted universe&hellip;","author":{"@type":"Person","name":"JieGG","url":"https://jie2gg.github.io/authors/jiegg/"},"publisher":{"@type":"Organization","name":"JieGG"}}</script><style>.u-tag--ai{--badge-bg:#84888E;--badge-txt:#FFFFFF;}</style><noscript><style>img[loading]{opacity:1;}</style></noscript></head><body class="post-template"><header class="topbar" id="js-header"><div class="topbar__inner"><a class="logo" href="https://jie2gg.github.io/">博客</a></div></header><div class="main-content"><div class="infobar"><div class="infobar__update">Last Updated: <time datetime="2024-08-16T16:28">八月 16, 2024</time></div></div><main class="main post"><article class="content"><header class="u-header content__header"><h1>大模型部署(一)——服务器环境安装</h1><div class="u-header__meta u-small"><div><a href="https://jie2gg.github.io/authors/jiegg/" title="JieGG">JieGG</a> <time datetime="2024-08-16T09:44">八月 16, 2024 </time><a href="https://jie2gg.github.io/tags/ai/" class="u-tag u-tag--ai">AI</a></div></div></header><div class="content__entry u-inner"><h3 id="本文介绍">本文介绍</h3><p>在部署基于 NVIDIA GPU 的大语言模型服务器时，确保系统具备合适的驱动程序和软件环境至关重要。首先，安装 NVIDIA GPU 驱动程序以启用 GPU 加速功能；接着，安装 CUDA 工具包来提供必要的编程接口和支持库；最后，安装 cuDNN 以加速深度神经网络的训练过程。这些步骤共同构成了一个高效的深度学习开发环境，能够显著提升模型训练和推理的速度。</p><p><code>⚠️注意：本文默认你会Linux操作基础，如果不会请先行学习Linux操作系统</code><br><code>⚠️注意：本文默认你会Linux操作基础，如果不会请先行学习Linux操作系统</code><br><code>⚠️注意：本文默认你会Linux操作基础，如果不会请先行学习Linux操作系统</code><br></p><h3 id="软件版本">软件版本</h3><p>本文章使用的软件版本将以本文编写时的最新版本作为演示（<strong>使用其他版本请注意安装方式</strong>），以下是所需的驱动软件的版本号。</p><ul><li>操作系统：<a href="https://cloud-images.ubuntu.com/releases/23.10/release-20240710/">Ubuntu 23.10</a></li><li>GPU驱动：<a href="https://cn.download.nvidia.com/tesla/550.90.07/NVIDIA-Linux-x86_64-550.90.07.run">550.90.07</a></li><li>CUDA-Toolkit：<a href="https://developer.download.nvidia.com/compute/cuda/12.6.0/local_installers/cuda_12.6.0_560.28.03_linux.run">12.6.0_560.28.03</a></li><li>cuDNN：<a href="https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2204/x86_64/cuda-keyring_1.1-1_all.deb">9.3.0</a></li></ul><h3 id="换源">换源</h3><p><strong>1. 备份原文件</strong></p><pre><code class="language-bash">$ cd /etc/apt
$ mv sources.list sources.list.bak
</code></pre><p><strong>2. 创建新文件</strong></p><pre><code class="language-bash">$ touch sources.list
</code></pre><p><strong>3. 在文件内写入下述源地址</strong></p><pre><code class="language-text"># 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ mantic main restricted universe multiverse
deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ mantic main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ mantic-updates main restricted universe multiverse
deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ mantic-updates main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ mantic-backports main restricted universe multiverse
deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ mantic-backports main restricted universe multiverse

# 以下安全更新软件源包含了官方源与镜像站配置，如有需要可自行修改注释切换
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ mantic-security main restricted universe multiverse
deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ mantic-security main restricted universe multiverse

# 预发布软件源，不建议启用
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ mantic-proposed main restricted universe multiverse
deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ mantic-proposed main restricted universe multiverse
</code></pre><p><strong>4. 更新源和操作系统</strong></p><pre><code class="language-bash">$ apt-get update
$ apt-get upgrade -y
</code></pre><h3 id="安装基本依赖">安装基本依赖</h3><pre><code class="language-bash">$ apt-get update
$ $ apt-get install -y build-essential dkms mdevctl cmake make wget curl
</code></pre><h3 id="安装驱动程序、cuda-toolkit、cudnn">安装驱动程序、CUDA-Toolkit、cuDNN</h3><p><strong>1. 下载软件包（如果你选择上传则忽略此步骤）</strong></p><pre><code class="language-bash"># 下载驱动
$ wget https://cn.download.nvidia.com/tesla/550.90.07/NVIDIA-Linux-x86_64-550.90.07.run

# 下载cuda-toolkit
$ wget https://developer.download.nvidia.com/compute/cuda/12.6.0/local_installers/cuda_12.6.0_560.28.03_linux.run

# 下载cuDNN
$ wget https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2204/x86_64/cuda-keyring_1.1-1_all.deb

# 设置权限
$ chmod +wx NVIDIA-Linux-x86_64-550.90.07.run
$ chmod +wx cuda_12.6.0_560.28.03_linux.run
</code></pre><p><strong>2. 安装驱动程序</strong></p><pre><code class="language-bash"># 安装 NVIDIA GPU驱动
$ ./NVIDIA-Linux-x86_64-550.90.07.run
</code></pre><ul><li><p>安装过程</p><figure class="post__image"><img loading="lazy" src="https://jie2gg.github.io/media/posts/4/install-gpu-driver-01.png" alt="install-gpu-driver-01" width="2348" height="1320" sizes="(max-width: 48em) 100vw, 768px" srcset="https://jie2gg.github.io/media/posts/4/responsive/install-gpu-driver-01-xs.png 300w, https://jie2gg.github.io/media/posts/4/responsive/install-gpu-driver-01-sm.png 480w, https://jie2gg.github.io/media/posts/4/responsive/install-gpu-driver-01-md.png 768w, https://jie2gg.github.io/media/posts/4/responsive/install-gpu-driver-01-lg.png 1024w, https://jie2gg.github.io/media/posts/4/responsive/install-gpu-driver-01-xl.png 1360w, https://jie2gg.github.io/media/posts/4/responsive/install-gpu-driver-01-2xl.png 1600w"></figure><p></p></li><li><p>使用遇到DKMS相关的选择YES</p><figure class="post__image"><img loading="lazy" src="https://jie2gg.github.io/media/posts/4/install-gpu-driver-03-2.png" alt="install-gpu-driver-02" width="2338" height="1330" sizes="(max-width: 48em) 100vw, 768px" srcset="https://jie2gg.github.io/media/posts/4/responsive/install-gpu-driver-03-2-xs.png 300w, https://jie2gg.github.io/media/posts/4/responsive/install-gpu-driver-03-2-sm.png 480w, https://jie2gg.github.io/media/posts/4/responsive/install-gpu-driver-03-2-md.png 768w, https://jie2gg.github.io/media/posts/4/responsive/install-gpu-driver-03-2-lg.png 1024w, https://jie2gg.github.io/media/posts/4/responsive/install-gpu-driver-03-2-xl.png 1360w, https://jie2gg.github.io/media/posts/4/responsive/install-gpu-driver-03-2-2xl.png 1600w"></figure><p></p></li><li><p>安装成功</p><figure class="post__image"><img loading="lazy" src="https://jie2gg.github.io/media/posts/4/install-gpu-driver-04.png" alt="install-gpu-driver-03" width="2362" height="1336" sizes="(max-width: 48em) 100vw, 768px" srcset="https://jie2gg.github.io/media/posts/4/responsive/install-gpu-driver-04-xs.png 300w, https://jie2gg.github.io/media/posts/4/responsive/install-gpu-driver-04-sm.png 480w, https://jie2gg.github.io/media/posts/4/responsive/install-gpu-driver-04-md.png 768w, https://jie2gg.github.io/media/posts/4/responsive/install-gpu-driver-04-lg.png 1024w, https://jie2gg.github.io/media/posts/4/responsive/install-gpu-driver-04-xl.png 1360w, https://jie2gg.github.io/media/posts/4/responsive/install-gpu-driver-04-2xl.png 1600w"></figure><p></p></li></ul><p><strong>3. 检查GPU状态</strong></p><pre><code class="language-bash"># 使用 nvidia-smi 检查 gpu 状态
$ nvidia-smi
</code></pre><p>正常情况下应该输出类似结果</p><figure class="post__image"><img loading="lazy" src="https://jie2gg.github.io/media/posts/4/install-gpu-driver-05.png" alt="install-gpu-driver-04" width="1390" height="990" sizes="(max-width: 48em) 100vw, 768px" srcset="https://jie2gg.github.io/media/posts/4/responsive/install-gpu-driver-05-xs.png 300w, https://jie2gg.github.io/media/posts/4/responsive/install-gpu-driver-05-sm.png 480w, https://jie2gg.github.io/media/posts/4/responsive/install-gpu-driver-05-md.png 768w, https://jie2gg.github.io/media/posts/4/responsive/install-gpu-driver-05-lg.png 1024w, https://jie2gg.github.io/media/posts/4/responsive/install-gpu-driver-05-xl.png 1360w, https://jie2gg.github.io/media/posts/4/responsive/install-gpu-driver-05-2xl.png 1600w"></figure><p></p><p><strong>4. 安装 CUDA 工具包</strong></p><pre><code class="language-bash"># 安装 cuda-toolkit
$ ./cuda_12.6.0_560.28.03_linux.run
</code></pre><ul><li><p>输入 accept 后开始安装</p><figure class="post__image"><img loading="lazy" src="https://jie2gg.github.io/media/posts/4/install-cuda-01.png" alt="install-cuda-01" width="1210" height="990" sizes="(max-width: 48em) 100vw, 768px" srcset="https://jie2gg.github.io/media/posts/4/responsive/install-cuda-01-xs.png 300w, https://jie2gg.github.io/media/posts/4/responsive/install-cuda-01-sm.png 480w, https://jie2gg.github.io/media/posts/4/responsive/install-cuda-01-md.png 768w, https://jie2gg.github.io/media/posts/4/responsive/install-cuda-01-lg.png 1024w, https://jie2gg.github.io/media/posts/4/responsive/install-cuda-01-xl.png 1360w, https://jie2gg.github.io/media/posts/4/responsive/install-cuda-01-2xl.png 1600w"></figure><p></p></li><li><p>取消选择 driver，开始安装</p><figure class="post__image"><img loading="lazy" src="https://jie2gg.github.io/media/posts/4/install-cuda-02.png" alt="install-cuda-02" width="1204" height="980" sizes="(max-width: 48em) 100vw, 768px" srcset="https://jie2gg.github.io/media/posts/4/responsive/install-cuda-02-xs.png 300w, https://jie2gg.github.io/media/posts/4/responsive/install-cuda-02-sm.png 480w, https://jie2gg.github.io/media/posts/4/responsive/install-cuda-02-md.png 768w, https://jie2gg.github.io/media/posts/4/responsive/install-cuda-02-lg.png 1024w, https://jie2gg.github.io/media/posts/4/responsive/install-cuda-02-xl.png 1360w, https://jie2gg.github.io/media/posts/4/responsive/install-cuda-02-2xl.png 1600w"></figure><p></p></li><li><p>安装成功</p><figure class="post__image"><img loading="lazy" src="https://jie2gg.github.io/media/posts/4/install-cuda-03.png" alt="install-cuda-03" width="2382" height="716" sizes="(max-width: 48em) 100vw, 768px" srcset="https://jie2gg.github.io/media/posts/4/responsive/install-cuda-03-xs.png 300w, https://jie2gg.github.io/media/posts/4/responsive/install-cuda-03-sm.png 480w, https://jie2gg.github.io/media/posts/4/responsive/install-cuda-03-md.png 768w, https://jie2gg.github.io/media/posts/4/responsive/install-cuda-03-lg.png 1024w, https://jie2gg.github.io/media/posts/4/responsive/install-cuda-03-xl.png 1360w, https://jie2gg.github.io/media/posts/4/responsive/install-cuda-03-2xl.png 1600w"></figure><p></p></li><li><p>设置环境变量</p></li></ul><pre><code class="language-bash"># 这里的版本根据安装成功后提示的路径进行设置
$ echo &#39;export PATH=$PATH:/usr/local/cuda-12.6/bin&#39; &gt;&gt; ~/.bashrc
$ echo &#39;export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/cuda-12.6/lib64&#39; &gt;&gt; ~/.bashrc
$ source ~/.bashrc
</code></pre><p><strong>5. 检查 CUDA 状态</strong></p><pre><code class="language-bash"># 使用 nvcc 检查版本
$ nvcc -V
</code></pre><p>正常情况应该输出如下结果</p><pre><code class="language-log">nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2024 NVIDIA Corporation
Built on Fri_Jun_14_16:34:21_PDT_2024
Cuda compilation tools, release 12.6, V12.6.20
Build cuda_12.6.r12.6/compiler.34431801_0
</code></pre><p><strong>6. 安装 cuDNN 神经网络库</strong></p><pre><code class="language-bash"># 使用 dpkg 安装 cudnn 源
$ dpkg -i cuda-keyring_1.1-1_all.deb

# 更新软件包并安装 cudnn
$ apt-get update
$ apt-get install -y cudnn-cuda-12
</code></pre></div><aside class="content__aside"><div class="content__last-updated u-small">This article was updated on 八月 16, 2024</div><div class="content__share"></div></aside><footer class="content__footer"><div class="content__bio box"><div><h4 class="h6"><a href="https://jie2gg.github.io/authors/jiegg/" title="JieGG">JieGG</a></h4></div></div><nav class="content__nav box"><div class="content__nav__next"><a href="https://jie2gg.github.io/da-mo-xing-bu-shuer-tui-li-kuang-jia-an-zhuang.html" class="content__nav__link" rel="next"><div class="u-small">Next Post<h5>大模型部署(二)——集群推理框架安装</h5></div></a></div></nav></footer></article></main><div class="sidebar"><section class="box authors"><h3 class="box__title">Authors</h3><ul class="authors__cotainer"><li class="authors__item"><div><a href="https://jie2gg.github.io/authors/jiegg/" class="authors__title">JieGG</a> <span class="u-small">Post: 3</span></div></li></ul></section><section class="newsletter box box--gray"><h3 class="box__title">Newsletter</h3><p class="newsletter__description">Sign up to receive email updates and to hear what's going on with us!</p><form>...</form></section><section class="box"><h3 class="box__title">Tags</h3><ul class="tags"><li><a href="https://jie2gg.github.io/tags/ai/">AI</a> <span class="u-small">(3)</span></li></ul></section></div><footer class="footer"><a class="footer__logo" href="https://jie2gg.github.io/">博客</a><nav><ul class="footer__nav"></ul></nav><div class="footer__copyright">Powered by Publii</div></footer></div><script>window.publiiThemeMenuConfig = {    
        mobileMenuMode: 'sidebar',
        animationSpeed: 300,
        submenuWidth: 'auto',
        doubleClickTime: 500,
        mobileMenuExpandableSubmenus: true, 
        relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script defer="defer" src="https://jie2gg.github.io/assets/js/scripts.min.js?v=18a65c58aef57c0287e0f0609f3389a9"></script><script>var images = document.querySelectorAll('img[loading]');

      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
               images[i].classList.add('is-loaded');
         } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
               }, false);
         }
      }</script></body></html>